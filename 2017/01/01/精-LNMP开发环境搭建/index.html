
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="代码狗">
    <title>[精]LNMP开发环境搭建 - 代码狗</title>
    <meta name="author" content="fantiq">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"fantiq","sameAs":["https://github.com/fantiq"],"image":"avatar.jpg"},"articleBody":"vagrant与dockervagrant 是一个对虚拟机的管理工具，方便搭建、移植自己的linux开发环境docker 是一种容器技术，每个服务(php-fpm mysql redis) 适合做成一个docker容器，方便本地模拟分布式开发环境换，保持开发环境与生产环境的高度一致\nvagrant制作与使用docker的制作与使用\n\n\n搭建本地开发环境\n1. 系统安装(centos6.8)1.1 最小化安装centos系统1.2 调整网络为自动分配(DHCP)12345678910# 编辑网卡配置文件vi /etc/sysconfig/network-scripts/ifcfg-eth0# 修改此项ONBOOT=no# 修改为ONBOOT=yes# 重启网卡service network restart# 可以ping同域名则 网络修改成功ping www.baidu.com\n\n1.3 分配网络为NAT virtualbox网络类型区别修改virtualbox : 设置 -&gt; 网络 选择NAT选择端口转发并添加一个映射规则\n12# 查看宿主机ip(eth0)ip a \n添加规则如下\n\n\n\n名称\n协议\n主机ip\n主机端口\n子系统ip\n子系统端口\n\n\n\nssh\nTCP\n127.0.0.1\n22\n10.0.2.15\n22\n\n\n\n通过TCP协议将宿主机的 127.0.0.1 22端口的请求转发到 10.0.2.15的22端口。此时可以通过ssh工具连接虚拟机了\n\n2. 更换yum源为epel12rpm -Uvh http://mirrors.kernel.org/fedora-epel/6/i386/epel-release-6-8.noarch.rpmyum repolist\n\n3. 安装增强工具 为vagrant做准备安装增强工具前需要先安装依赖包 并更新更新 yum源 并重启\n123456# 安装依赖包yum -y install bzip2 make automake gcc gcc-c++ kernel-devel kernel-headers# 更新yum包yum update# 重启reboot\n安装增强工具\n12345678#挂载增强工具盘设备-&gt; 安装增强工具#挂载硬盘mkdir /mnt/cdrommount -t auto -o ro /dev/cdrom /mnt/cdrom# 执行cd /mnt/cdrom./VBoxLinuxAdditions.run\n如遇到错误提示\n1Could not find the X.Org or XFree86 Window System, skipping\n属于正常，因为我们没有安装GUI\n4. 基础服务安装创建下载源代码的目录 安装下载工具wget\n1234yum install -y wgetcd ~mkdir srccd src\n4.1 nginx下载并解压\n12wget https://nginx.org/download/nginx-1.10.1.tar.gztar -zxvf nginx-1.10.1.tar.gz\n安装依赖包\n1yum -y install gcc autoconf automake zlib zlib-devel openssl openssl-devel pcre-devel\n编译安装\n1234567891011121314151617181920cd nginx-1.10.1./configure \\--prefix=/usr/local/nginx \\--sbin-path=/usr/local/nginx/sbin/nginx \\--conf-path=/usr/local/nginx/conf/nginx.conf \\--error-log-path=/var/log/nginx/error.log \\--pid-path=/var/run/nginx/nginx.pid \\--user=nginx \\--group=nginx \\--with-http_ssl_module \\--with-http_flv_module \\--with-http_gzip_static_module \\--http-log-path=/var/log/nginx/access.log \\--http-client-body-temp-path=/var/tmp/nginx/client \\--http-proxy-temp-path=/var/tmp/nginx/proxy \\--http-fastcgi-temp-path=/var/tmp/nginx/fcgi \\--with-http_stub_status_modulemake &amp;&amp; make install\n启动服务\n12345# 添加nginx运行用户以及对应用户组groupadd -r nginx useradd -s /sbin/nologin -g nginx -r nginx# 启动服务/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf\n启动过程中遇到错误\n123nginx: [emerg] mkdir() &quot;/var/tmp/nginx/client&quot; failed (2: No such file or directory)# 创建对应的目录mkdir -p /var/tmp/nginx/client\n4.2 node下载并解压\n1234567# 下载文件wget https://nodejs.org/dist/v6.9.2/node-v6.9.2-linux-x64.tar.xz# 下载解压工具yum -y install xz# 解压xz -d node-v6.9.2-linux-x64.tar.xztag -xvf node-v6.9.2-linux-x64.tar.xz\n安装(这里下载的是编译好的文件 可以直接使用)\n12345678# 移动文件mv node-v6.9.2-linux-x64 /usr/local/node# 创建软链接ln -s /usr/local/node/bin/node /usr/local/bin/nodeln -s /usr/local/node/bin/npm  /usr/local/bin/npm# 查看版本node -vnpm -v\n4.3 mysql下载并解压 \n12wget http://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.14.tar.gztar -zxvf mysql-5.7.14.tar.gz\n安装依赖包\n12345yum -y install gcc gcc-c++ ncurses-devel cmake bison# 下载boostwget https://sourceforge.net/projects/boost/files/boost/1.59.0/boost_1_59_0.tar.gztar -zxvf boost_1_59_0.tar.gzmv boost_1_59_0 /usr/local/boost\n编译安装\n123456789101112131415161718192021cd mysql-5.7.14cmake . \\-DCMAKE_INSTALL_PREFIX=/usr/local/mysql \\-DMYSQL_DATADIR=/usr/local/mysql/data \\-DDEFAULT_CHARSET=utf8 \\-DDEFAULT_COLLATION=utf8_general_ci \\-DMYSQL_TCP_PORT=3306 \\-DMYSQL_USER=mysql \\-DWITH_MYISAM_STORAGE_ENGINE=1 \\-DWITH_INNOBASE_STORAGE_ENGINE=1 \\-DWITH_ARCHIVE_STORAGE_ENGINE=1 \\-DWITH_BLACKHOLE_STORAGE_ENGINE=1 \\-DWITH_MEMORY_STORAGE_ENGINE=1 \\-DDOWNLOAD_BOOST=1 \\-DWITH_BOOST=/usr/local/boostmake &amp;&amp; make install# 编译错误 需要清理make文件rm -f CMakeCache.txtmake clean\n创建mysql执行用户\n12groupadd -r mysqluseradd -s /sbin/nologin -g mysql -r mysql\n初始化mysql\n123456789101112131415# 创建数据库文件存储目录mkdir -p /var/lib/mysql# 赋予权限chown -R mysql:mysql /var/lib/mysql# 初始化配置/usr/local/mysql/bin/mysqld \\--initialize-insecure \\--user=mysql \\--basedir=/usr/local/mysql \\--datadir=/var/lib/mysql/data# --initialize 初始化mysql  会给root生成默认随机密码# --initialize-insecure 初始化mysql 但 不会给root生成随机密码# --user 指定mysql执行的用户# --basedir mysql的安装路径# --datadir 指定数据存储路径 这个路径必须是空文件夹 当然也要有读写权限\n启动mysql1 查找 /etc/my.cnf 是否存在 不存在的话 拷贝一份\n1cp /usr/local/mysql/support-files/my-default.cnf /etc/my.cnf\n2 修改配置文件\n1234567891011121314151617[client]# 配置客户端sock文件 不然 mysql命令报错# ERROR 2002 (HY000): Can&#x27;t connect to local MySQL server through socket &#x27;/tmp/mysql.sock&#x27; (2)socket=/var/lib/mysql/mysql.sock[mysqld]# 数据库文件存储位置 这个一定要填写正确 且 有读写权限不然会报错 # Starting MySQL........ ERROR! The server quit without updating PID file (/var/lib/mysql/develop.pid).datadir=/var/lib/mysql/datasocket=/var/lib/mysql/mysql.sock# mysql服务执行的用户user=mysql# Disabling symbolic-links is recommended to prevent assorted security riskssymbolic-links=0[mysqld_safe]log-error=/var/log/mysqld.logpid-file=/var/run/mysqld/mysqld.pid\n3 启动服务\n1/usr/local/mysql/support-files/mysql.serve start\n4 将mysql添加到系统服务 且 开机启动\n12345678# 拷贝文件cp /usr/local/mysql/support-files/mysql.serve /etc/init.d/mysqld# 查看服务状态service mysqld status# 设置为开机启动chkconfig --add mysqldchkconfig mysqld on\n\n4.4 redis下载并解压\n12wget http://download.redis.io/releases/redis-3.2.6.tar.gztar -zxvf redis-3.2.6.tar.gz\n编译安装\n12cd redis-3.2.6make PREFIX=/usr/local/redis install\n启动服务\n123456789# 拷贝配置文件cp redis.conf /usr/local/redis/# 修改配置文件 redis为后台进程# 找到daemonize no# 修改为daemonize yes# 启动服务/usr/local/redis/bin/redis-server /usr/local/redis/redis.conf\n4.5 mongodb下载解压\n1234wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.4.1.tgztar -zxvf mongodb-linux-x86_64-3.4.1.tgz# 由于下载的是二进制文件 可以直接使用cp -r mongodb-linux-x86_64-3.4.1 /usr/local/mongodb\n启动服务\n12345678# --dbpath 指定文件存储的目录/usr/local/mongodb/bin/mongod --dbpath# 连接客户端/usr/local/mongodb/bin/mongo&gt;show dbs&gt;use admin&gt;show collections&gt;db.collection.find()\n4.6 php下载解压\n12wget http://cn2.php.net/distributions/php-7.0.9.tar.gztar -zxvf php-7.0.9.tar.gz\n安装依赖包\n1234567891011yum -y install openssl openssl-devel \\\t\t# 支持 stlcurl curl-devel \\\t\t\t# curl网络请求库libjpeg libjpeg-devel \\\t\t# jpeg图片libpng libpng-devel \\\t\t# png 图片freetype freetype-devel \\\t# freetype 字体libxml2 libxml2-devel \\\t\t# xml格式解析libxslt libxslt-devel \\\t\t# bzip2 bzip2-devel \\\t\t\t# bzip2 压缩库pcre pcre-devel \\\t\t\t# pcre正则库\n编译安装核心配置选项列表\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950cd php-7.0.9./configure \\--prefix=/usr/local/php7 \\--exec-prefix=/usr/local/php7 \\--bindir=/usr/local/php7/bin \\--sbindir=/usr/local/php7/sbin \\--includedir=/usr/local/php7/include \\--libdir=/usr/local/php7/lib/php \\--mandir=/usr/local/php7/php/man \\--with-config-file-path=/usr/local/php7/etc \\--with-mysql-sock=/var/run/mysql/mysql.sock \\--with-mcrypt=/usr/include \\--with-mhash \\--with-openssl \\--with-mysqli=shared,mysqlnd \\--with-pdo-mysql=shared,mysqlnd \\--with-gd \\--with-iconv \\--with-zlib \\--enable-zip \\--enable-inline-optimization \\--disable-debug \\--disable-rpath \\--enable-shared \\--enable-xml \\--enable-bcmath \\--enable-shmop \\--enable-sysvsem \\--enable-mbregex \\--enable-mbstring \\--enable-ftp \\--enable-gd-native-ttf \\--enable-pcntl \\--enable-sockets \\--with-xmlrpc \\--enable-soap \\--without-pear \\--with-gettext \\--enable-session \\--with-curl \\--with-jpeg-dir \\--with-freetype-dir \\--enable-opcache \\--enable-fpm \\--with-fpm-user=nginx \\--with-fpm-group=nginx \\--without-gdbm \\--enable-fileinfomake &amp;&amp; make install\n配置相关的修改\n123456789101112131415161718192021# 添加链接ln -s /usr/local/php7/bin/php /usr/local/bin# php配置文件(从源代码中拷贝)cp php.ini-development /usr/local/php7/etc/php.ini# php-fpm 配置文件cp /usr/local/php7/etc/php-fpm.conf.default /usr/local/php7/etc/php-fpm.confcp /usr/local/php7/etc/php-fpm.d/www.conf.default /usr/local/php7/etc/php-fpm.d/www.conf# 修改配置文件vi /usr/local/php7/etc/php-fpm.d/www.conf;listen = 127.0.0.1:9000listen = /dev/shm/php-fpm.sock# 下面两个选项的注释一定要开启 不然nginx连接fpm的sock会报权限错误listen.owner = nginxlisten.group = nginx# 启动服务/usr/local/php7/sbin/php-fpm# 查看是否开启成功ps -ef | grep php-fpm# 这个时候查看生成的 php-fpm.sock 的创建者与所属组都是 nginxll /dev/shm\n\n\n4.7 php-extphp扩展安装\n12345678910111213# redis下载解压wget http://pecl.php.net/get/redis-3.1.0.tgztar -zxvf redis-3.1.0.tgz# mongodb下载解压wget http://pecl.php.net/get/mongodb-1.2.2.tgztar -zxvf mongodb-1.2.2.tgz# php提供的扩展安装工具# 在扩展源码根目录下执行# 生成configure文件/usr/local/php7/bin/phpize./configure --with-php-config=/usr/local/php7/bin/php-config# 编译安装make &amp;&amp; make install\n配置文件开启扩展\n12345678vi /usr/local/php7/etc/php.ini# 添加如下选项extension=redis.soextension=mongodb.soextension=pdo_mysql.sozend_extension=opcache.so# 查看扩展php -m\ncomposer 安装\n12345# 下载curl -sS https://getcomposer.org/installer | phpmv composer.phar /usr/local/bin/composer# 验证composer -v\n5. 常用工具安装5.1 supervisor命令行执行脚本的守护进程\n1234# 安装yum -y install supervisor# 查看是否安装成功service supervsord status\n配置文件说明\n12345678910111213141516vi /etc/supervisord.conf# 配置详解[program:任务名称]# 守护执行的命令command=/root/test/shell/test# 命令执行的用户 这里设置出错会导致权限问题user=root# 是否自动启动autostart=true# 是否自动重启autorestart=truestartsecs=3# 是否捕获错误redirect_stderr=true# 错误日志stdout_logfile=/root/test/shellsupervisor.log\n基本常用命令\n12345678# 帮助supervisorctl help# 查看状态supervisorctl status# 修改配置文件需要重新加载supervisorctl reload# 重启 启动 停止supervisorctl start/restart/stop\n\n参考连接\n5.2 nfs-utils网络磁盘共享 图片文件会用到\n1234567891011121314151617181920# 安装yum -y install nfs-utils# 查看安装情况rpm -qa | grep nfs# --- 看到这些包表示安装成功---nfs-utils-lib-1.1.5-11.el6.x86_64nfs-utils-1.2.3-70.el6_8.2.x86_64# 服务端编辑权限vi /etc/exports# /path client_ip (读写权限,访问角色,同步还是异步)/data/images 192.168.0.* (rw,root_squash,async)# 权限编辑后需要重新加载生效exportfs -rv# 开启服务 (客户端 服务端同时需要开启服务)# contos 5.x 版本使用的是portmap# centos 6.x 版本使用的是rpcbindservice rpcbind startservice nfs start# 客户端挂载硬盘mount -t nfs remote_ip:/path /local/data\n\n5.3 samba目录共享系统\n1234# 安装yum -y install samba# 查看安装情况service smb status\n配置文件详解\n12345678910111213141516vi /etc/samba/smb.conf# 修改以下选项 否则每次访问需要登录#security = usersecurity = share# 添加一个共享目录[共享的名称]comment=注释描述path=/root/share # 共享的文件夹路径browseable=yes # 是否有浏览权限guest ok=yes # 访客是否可访问public=yes  # 是否允许上传writable=yes # 是否有可写权限# 重启服务service smb restart\n\n5.4 docker-iodocker安装\n12yum -y install docker-ioservice docker status\ndocker常用命令\n5.5 git1yum -y install git\ngit命令详解\n6. vim 安装与配置6.1 vim源码下载解压12wget ftp://ftp.vim.org/pub/vim/unix/vim-7.4.tar.bz2tar -jxvf vim-7.4.tar.bz2\n6.2 安装依赖包12345678yum install -y lua lua-devel python python-devel perl perl-devel perl-ExtUtils-Embed ruby ruby-devel# 编译安装 lua-jitwget http://luajit.org/download/LuaJIT-2.0.4.tar.gztar zxf LuaJIT-2.0.4.tar.gzcd LuaJIT-2.0.4# 这里安装默认路径 不然编译vim的时候找不到文件makemake install\n6.3 vim源码 编译安装123456789101112131415161718./configure \\--prefix=/usr/local/vim7.4 \\--disable-selinux \\--enable-luainterp=yes \\--enable-perlinterp \\--enable-rubyinterp \\--enable-pythoninterp \\--with-python-config-dir=/usr/lib64/python2.6/config \\--enable-fail-if-missing \\--enable-cscope \\--enable-gui=auto \\--enable-gtk2-check \\--enable-gnome-check \\--with-features=huge \\--with-luajit \\--with-x make &amp;&amp; make install\n\n使用 vim 以及错误解决\n12345678ln -s /usr/local/vim7.4/bin/vim /usr/local/bin/# 这个时候使用vim报错# vim: error while loading shared libraries: libluajit-5.1.so.2: cannot open shared object file: No such file or directory# 通过生成软连接 解决ln -s /usr/local/lib/libluajit-5.1.so.2 /lib64/# 检查插件支持vim 命令行模式输入:version\n\n6.4 插件 配置文件安装1234# 拷贝 .vimrc 配置文件# 创建目录mkdir -p ~/.vim/bundlemkdir -p ~/.vim/colors\n\n安装包管理器 Bundle\n1234# 下载bundlegit clone https://github.com/VundleVim/Vundle.vim.git ~/.vim/bundle/Vundle.vim# 安装插件:BundleInstall\n\n安装插件 Command-T\n1234# Command-T 安装 找到下载的源码cd ~/.vim/bundle/command-t/ruby/command-truby extconf.rbmake\n安装插件 Ctags\n12345678wget https://nchc.dl.sourceforge.net/project/ctags/ctags/5.8/ctags-5.8.tar.gztar zxvf ctags-5.8.tar.gzcd ctags-5.8./configure --prefix=/usr/local/ctagsmake &amp;&amp; make installln -s /usr/local/ctags/bin/ctags /usr/local/bin/ctagsctags --version\n\n\n7. 制作vagrant7.1 添加sudo用户12345678# 添加用户useradd vagratpasswd vagrant&gt;password: vagrant#### 7.2  添加vagrant用户到sudoervisudo# 增加行vagrant ALL=(ALL) NOPASSWD:ALL\nsudo 文件格式解释\n12345678user host=(run_as) command# user 定义用户或者用户组 用户组以 % 开始 如 %vagrant# host 主机名# run_as 作为哪个用户执行 不写(run_as) 默认是 root# command 可执行的命令 这个命令要写全路径 相对路径存在安全问题(用户可以创建同名脚本 以root用户执行脚本 脚本里的命令就可以按照root用户的权限执行了)# command 前可以通过 NOPASSWD: 来修饰 表示sudo执行命令的时候不用密码%vagrant ALL=(root) NOPASSWD:/usr/sbin/useradd# 上面命令定义 vagrant组的用户可以在所有主机以root身份执行 /usr/sbin/useradd 命令且不需要密码\n7.3 创建vagrant登录授权key12345su vagrantmkdir -p /home/vagrant/.sshcd /home/vagrant/.sshwget https://raw.githubusercontent.com/mitchellh/vagrant/master/keys/vagrant.pub -O authorized_keyschmod 600 /home/vagrant/.ssh/authorized_keys\n7.4 vagrant 打包打包虚拟机\n123456# 查看虚拟机VBoxManage list vms# vagrant 打包vagrant package --base VBoxName --output develop.box# 设置vagrant存储位置 设置系统常量VAGRANT_HOME=/d/storage/vagrant\n\n使用 vagrant 包\n123456789101112vagrant box add centos-dev develop.boxvagrant init centos-dev #修改Vagrantfile# 使用帐号密码登录config.ssh.username=&quot;vagrant&quot;config.ssh.password=&quot;vagrant&quot;# 使用key登录config.ssh.private_key_path=&quot;&quot;# 启动vagrant up\n\n\n另外在开发过程中我们常常会修改配置文件这个时候可以将配置文件放在映射的目录然后通过软连接(ln -s) 将文件映射到服务读取的配置文件\n","dateCreated":"2017-01-01T21:22:08+08:00","dateModified":"2018-04-08T21:39:58+08:00","datePublished":"2017-01-01T21:22:08+08:00","description":"vagrant与dockervagrant 是一个对虚拟机的管理工具，方便搭建、移植自己的linux开发环境docker 是一种容器技术，每个服务(php-fpm mysql redis) 适合做成一个docker容器，方便本地模拟分布式开发环境换，保持开发环境与生产环境的高度一致\nvagrant制作与使用docker的制作与使用","headline":"[精]LNMP开发环境搭建","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://fantiq.github.io/2017/01/01/%E7%B2%BE-LNMP%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"},"publisher":{"@type":"Organization","name":"fantiq","sameAs":["https://github.com/fantiq"],"image":"avatar.jpg","logo":{"@type":"ImageObject","url":"avatar.jpg"}},"url":"https://fantiq.github.io/2017/01/01/%E7%B2%BE-LNMP%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"}</script>
    <meta name="description" content="vagrant与dockervagrant 是一个对虚拟机的管理工具，方便搭建、移植自己的linux开发环境docker 是一种容器技术，每个服务(php-fpm mysql redis) 适合做成一个docker容器，方便本地模拟分布式开发环境换，保持开发环境与生产环境的高度一致 vagrant制作与使用docker的制作与使用">
<meta property="og:type" content="blog">
<meta property="og:title" content="[精]LNMP开发环境搭建">
<meta property="og:url" content="https://fantiq.github.io/2017/01/01/%E7%B2%BE-LNMP%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/index.html">
<meta property="og:site_name" content="代码狗">
<meta property="og:description" content="vagrant与dockervagrant 是一个对虚拟机的管理工具，方便搭建、移植自己的linux开发环境docker 是一种容器技术，每个服务(php-fpm mysql redis) 适合做成一个docker容器，方便本地模拟分布式开发环境换，保持开发环境与生产环境的高度一致 vagrant制作与使用docker的制作与使用">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2017-01-01T13:22:08.000Z">
<meta property="article:modified_time" content="2018-04-08T13:39:58.000Z">
<meta property="article:author" content="fantiq">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="https://fantiq.github.io/assets/images/avatar.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-bo1h1ya3kmjmd94f0k5yc43ngmshulfcyc8apgyrr2pfx48g1zk5lyp9do8g.min.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            代码狗
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="打开链接: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/avatar.jpg" alt="作者的图片"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="阅读有关作者的更多信息"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/avatar.jpg" alt="作者的图片"/>
                </a>
                <h4 class="sidebar-profile-name">fantiq</h4>
                
                    <h5 class="sidebar-profile-bio"><p>author.bio</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="首页"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首页</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="分类"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分类</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="标签"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">标签</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="归档"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">归档</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="搜索"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">搜索</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/fantiq"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            [精]LNMP开发环境搭建
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2017-01-01T21:22:08+08:00">
	
		    1月 01, 2017
    	
    </time>
    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>vagrant与docker<br>vagrant 是一个对虚拟机的管理工具，方便搭建、移植自己的linux开发环境<br>docker 是一种容器技术，每个服务(php-fpm mysql redis) 适合做成一个docker容器，方便本地模拟分布式开发环境换，保持开发环境与生产环境的高度一致</p>
<p><a href="">vagrant制作与使用</a><br><a href="">docker的制作与使用</a></p>
<span id="more"></span>

<p>搭建本地开发环境</p>
<h2 id="1-系统安装-centos6-8"><a href="#1-系统安装-centos6-8" class="headerlink" title="1. 系统安装(centos6.8)"></a>1. 系统安装(centos6.8)</h2><h4 id="1-1-最小化安装centos系统"><a href="#1-1-最小化安装centos系统" class="headerlink" title="1.1 最小化安装centos系统"></a>1.1 最小化安装centos系统</h4><h4 id="1-2-调整网络为自动分配-DHCP"><a href="#1-2-调整网络为自动分配-DHCP" class="headerlink" title="1.2 调整网络为自动分配(DHCP)"></a>1.2 调整网络为自动分配(DHCP)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 编辑网卡配置文件</span><br><span class="line">vi /etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class="line"># 修改此项</span><br><span class="line">ONBOOT=no</span><br><span class="line"># 修改为</span><br><span class="line">ONBOOT=yes</span><br><span class="line"># 重启网卡</span><br><span class="line">service network restart</span><br><span class="line"># 可以ping同域名则 网络修改成功</span><br><span class="line">ping www.baidu.com</span><br></pre></td></tr></table></figure>

<h4 id="1-3-分配网络为NAT-virtualbox网络类型区别"><a href="#1-3-分配网络为NAT-virtualbox网络类型区别" class="headerlink" title="1.3 分配网络为NAT virtualbox网络类型区别"></a>1.3 分配网络为NAT <a href="">virtualbox网络类型区别</a></h4><p>修改<code>virtualbox : 设置 -&gt; 网络</code> 选择NAT<br>选择<code>端口转发</code>并添加一个映射规则</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 查看宿主机ip(eth0)</span><br><span class="line">ip a </span><br></pre></td></tr></table></figure>
<p>添加规则如下</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>协议</th>
<th>主机ip</th>
<th>主机端口</th>
<th>子系统ip</th>
<th>子系统端口</th>
</tr>
</thead>
<tbody><tr>
<td>ssh</td>
<td>TCP</td>
<td>127.0.0.1</td>
<td>22</td>
<td>10.0.2.15</td>
<td>22</td>
</tr>
</tbody></table>
<blockquote>
<p>通过TCP协议将宿主机的 127.0.0.1 22端口的请求转发到 10.0.2.15的22端口。此时可以通过ssh工具连接虚拟机了</p>
</blockquote>
<h2 id="2-更换yum源为epel"><a href="#2-更换yum源为epel" class="headerlink" title="2. 更换yum源为epel"></a>2. 更换yum源为epel</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh http://mirrors.kernel.org/fedora-epel/6/i386/epel-release-6-8.noarch.rpm</span><br><span class="line">yum repolist</span><br></pre></td></tr></table></figure>

<h2 id="3-安装增强工具-为vagrant做准备"><a href="#3-安装增强工具-为vagrant做准备" class="headerlink" title="3. 安装增强工具 为vagrant做准备"></a>3. 安装增强工具 为vagrant做准备</h2><p>安装增强工具前需要先安装依赖包 并更新更新 yum源 并重启</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 安装依赖包</span><br><span class="line">yum -y install bzip2 make automake gcc gcc-c++ kernel-devel kernel-headers</span><br><span class="line"># 更新yum包</span><br><span class="line">yum update</span><br><span class="line"># 重启</span><br><span class="line">reboot</span><br></pre></td></tr></table></figure>
<p>安装增强工具</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#挂载增强工具盘</span><br><span class="line">设备-&gt; 安装增强工具</span><br><span class="line">#挂载硬盘</span><br><span class="line">mkdir /mnt/cdrom</span><br><span class="line">mount -t auto -o ro /dev/cdrom /mnt/cdrom</span><br><span class="line"># 执行</span><br><span class="line">cd /mnt/cdrom</span><br><span class="line">./VBoxLinuxAdditions.run</span><br></pre></td></tr></table></figure>
<p>如遇到错误提示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Could not find the X.Org or XFree86 Window System, skipping</span><br></pre></td></tr></table></figure>
<p>属于正常，因为我们没有安装GUI</p>
<h2 id="4-基础服务安装"><a href="#4-基础服务安装" class="headerlink" title="4. 基础服务安装"></a>4. 基础服务安装</h2><p>创建下载源代码的目录 安装下载工具<code>wget</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install -y wget</span><br><span class="line">cd ~</span><br><span class="line">mkdir src</span><br><span class="line">cd src</span><br></pre></td></tr></table></figure>
<h4 id="4-1-nginx"><a href="#4-1-nginx" class="headerlink" title="4.1 nginx"></a>4.1 nginx</h4><p>下载并解压</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://nginx.org/download/nginx-1.10.1.tar.gz</span><br><span class="line">tar -zxvf nginx-1.10.1.tar.gz</span><br></pre></td></tr></table></figure>
<p>安装依赖包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc autoconf automake zlib zlib-devel openssl openssl-devel pcre-devel</span><br></pre></td></tr></table></figure>
<p>编译安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">cd nginx-1.10.1</span><br><span class="line"></span><br><span class="line">./configure \</span><br><span class="line">--prefix=/usr/local/nginx \</span><br><span class="line">--sbin-path=/usr/local/nginx/sbin/nginx \</span><br><span class="line">--conf-path=/usr/local/nginx/conf/nginx.conf \</span><br><span class="line">--error-log-path=/var/log/nginx/error.log \</span><br><span class="line">--pid-path=/var/run/nginx/nginx.pid \</span><br><span class="line">--user=nginx \</span><br><span class="line">--group=nginx \</span><br><span class="line">--with-http_ssl_module \</span><br><span class="line">--with-http_flv_module \</span><br><span class="line">--with-http_gzip_static_module \</span><br><span class="line">--http-log-path=/var/log/nginx/access.log \</span><br><span class="line">--http-client-body-temp-path=/var/tmp/nginx/client \</span><br><span class="line">--http-proxy-temp-path=/var/tmp/nginx/proxy \</span><br><span class="line">--http-fastcgi-temp-path=/var/tmp/nginx/fcgi \</span><br><span class="line">--with-http_stub_status_module</span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>启动服务</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 添加nginx运行用户以及对应用户组</span><br><span class="line">groupadd -r nginx </span><br><span class="line">useradd -s /sbin/nologin -g nginx -r nginx</span><br><span class="line"># 启动服务</span><br><span class="line">/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf</span><br></pre></td></tr></table></figure>
<p>启动过程中遇到错误</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nginx: [emerg] mkdir() &quot;/var/tmp/nginx/client&quot; failed (2: No such file or directory)</span><br><span class="line"># 创建对应的目录</span><br><span class="line">mkdir -p /var/tmp/nginx/client</span><br></pre></td></tr></table></figure>
<h4 id="4-2-node"><a href="#4-2-node" class="headerlink" title="4.2 node"></a>4.2 node</h4><p>下载并解压</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 下载文件</span><br><span class="line">wget https://nodejs.org/dist/v6.9.2/node-v6.9.2-linux-x64.tar.xz</span><br><span class="line"># 下载解压工具</span><br><span class="line">yum -y install xz</span><br><span class="line"># 解压</span><br><span class="line">xz -d node-v6.9.2-linux-x64.tar.xz</span><br><span class="line">tag -xvf node-v6.9.2-linux-x64.tar.xz</span><br></pre></td></tr></table></figure>
<p>安装(这里下载的是编译好的文件 可以直接使用)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 移动文件</span><br><span class="line">mv node-v6.9.2-linux-x64 /usr/local/node</span><br><span class="line"># 创建软链接</span><br><span class="line">ln -s /usr/local/node/bin/node /usr/local/bin/node</span><br><span class="line">ln -s /usr/local/node/bin/npm  /usr/local/bin/npm</span><br><span class="line"># 查看版本</span><br><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure>
<h4 id="4-3-mysql"><a href="#4-3-mysql" class="headerlink" title="4.3 mysql"></a>4.3 mysql</h4><p>下载并解压 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.14.tar.gz</span><br><span class="line">tar -zxvf mysql-5.7.14.tar.gz</span><br></pre></td></tr></table></figure>
<p>安装依赖包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc gcc-c++ ncurses-devel cmake bison</span><br><span class="line"># 下载boost</span><br><span class="line">wget https://sourceforge.net/projects/boost/files/boost/1.59.0/boost_1_59_0.tar.gz</span><br><span class="line">tar -zxvf boost_1_59_0.tar.gz</span><br><span class="line">mv boost_1_59_0 /usr/local/boost</span><br></pre></td></tr></table></figure>
<p>编译安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">cd mysql-5.7.14</span><br><span class="line"></span><br><span class="line">cmake . \</span><br><span class="line">-DCMAKE_INSTALL_PREFIX=/usr/local/mysql \</span><br><span class="line">-DMYSQL_DATADIR=/usr/local/mysql/data \</span><br><span class="line">-DDEFAULT_CHARSET=utf8 \</span><br><span class="line">-DDEFAULT_COLLATION=utf8_general_ci \</span><br><span class="line">-DMYSQL_TCP_PORT=3306 \</span><br><span class="line">-DMYSQL_USER=mysql \</span><br><span class="line">-DWITH_MYISAM_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_INNOBASE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_ARCHIVE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_BLACKHOLE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_MEMORY_STORAGE_ENGINE=1 \</span><br><span class="line">-DDOWNLOAD_BOOST=1 \</span><br><span class="line">-DWITH_BOOST=/usr/local/boost</span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"># 编译错误 需要清理make文件</span><br><span class="line">rm -f CMakeCache.txt</span><br><span class="line">make clean</span><br></pre></td></tr></table></figure>
<p>创建mysql执行用户</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">groupadd -r mysql</span><br><span class="line">useradd -s /sbin/nologin -g mysql -r mysql</span><br></pre></td></tr></table></figure>
<p>初始化mysql</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 创建数据库文件存储目录</span><br><span class="line">mkdir -p /var/lib/mysql</span><br><span class="line"># 赋予权限</span><br><span class="line">chown -R mysql:mysql /var/lib/mysql</span><br><span class="line"># 初始化配置</span><br><span class="line">/usr/local/mysql/bin/mysqld \</span><br><span class="line">--initialize-insecure \</span><br><span class="line">--user=mysql \</span><br><span class="line">--basedir=/usr/local/mysql \</span><br><span class="line">--datadir=/var/lib/mysql/data</span><br><span class="line"># --initialize 初始化mysql  会给root生成默认随机密码</span><br><span class="line"># --initialize-insecure 初始化mysql 但 不会给root生成随机密码</span><br><span class="line"># --user 指定mysql执行的用户</span><br><span class="line"># --basedir mysql的安装路径</span><br><span class="line"># --datadir 指定数据存储路径 这个路径必须是空文件夹 当然也要有读写权限</span><br></pre></td></tr></table></figure>
<p>启动mysql<br>1 查找 /etc/my.cnf 是否存在 不存在的话 拷贝一份</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/local/mysql/support-files/my-default.cnf /etc/my.cnf</span><br></pre></td></tr></table></figure>
<p>2 修改配置文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line"># 配置客户端sock文件 不然 mysql命令报错</span><br><span class="line"># ERROR 2002 (HY000): Can&#x27;t connect to local MySQL server through socket &#x27;/tmp/mysql.sock&#x27; (2)</span><br><span class="line">socket=/var/lib/mysql/mysql.sock</span><br><span class="line">[mysqld]</span><br><span class="line"># 数据库文件存储位置 这个一定要填写正确 且 有读写权限不然会报错 </span><br><span class="line"># Starting MySQL........ ERROR! The server quit without updating PID file (/var/lib/mysql/develop.pid).</span><br><span class="line">datadir=/var/lib/mysql/data</span><br><span class="line">socket=/var/lib/mysql/mysql.sock</span><br><span class="line"># mysql服务执行的用户</span><br><span class="line">user=mysql</span><br><span class="line"># Disabling symbolic-links is recommended to prevent assorted security risks</span><br><span class="line">symbolic-links=0</span><br><span class="line"></span><br><span class="line">[mysqld_safe]</span><br><span class="line">log-error=/var/log/mysqld.log</span><br><span class="line">pid-file=/var/run/mysqld/mysqld.pid</span><br></pre></td></tr></table></figure>
<p>3 启动服务</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/mysql/support-files/mysql.serve start</span><br></pre></td></tr></table></figure>
<p>4 将mysql添加到系统服务 且 开机启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 拷贝文件</span><br><span class="line">cp /usr/local/mysql/support-files/mysql.serve /etc/init.d/mysqld</span><br><span class="line"># 查看服务状态</span><br><span class="line">service mysqld status</span><br><span class="line"></span><br><span class="line"># 设置为开机启动</span><br><span class="line">chkconfig --add mysqld</span><br><span class="line">chkconfig mysqld on</span><br></pre></td></tr></table></figure>

<h4 id="4-4-redis"><a href="#4-4-redis" class="headerlink" title="4.4 redis"></a>4.4 redis</h4><p>下载并解压</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/releases/redis-3.2.6.tar.gz</span><br><span class="line">tar -zxvf redis-3.2.6.tar.gz</span><br></pre></td></tr></table></figure>
<p>编译安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd redis-3.2.6</span><br><span class="line">make PREFIX=/usr/local/redis install</span><br></pre></td></tr></table></figure>
<p>启动服务</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 拷贝配置文件</span><br><span class="line">cp redis.conf /usr/local/redis/</span><br><span class="line"># 修改配置文件 redis为后台进程</span><br><span class="line"># 找到</span><br><span class="line">daemonize no</span><br><span class="line"># 修改为</span><br><span class="line">daemonize yes</span><br><span class="line"># 启动服务</span><br><span class="line">/usr/local/redis/bin/redis-server /usr/local/redis/redis.conf</span><br></pre></td></tr></table></figure>
<h4 id="4-5-mongodb"><a href="#4-5-mongodb" class="headerlink" title="4.5 mongodb"></a>4.5 mongodb</h4><p>下载解压</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.4.1.tgz</span><br><span class="line">tar -zxvf mongodb-linux-x86_64-3.4.1.tgz</span><br><span class="line"># 由于下载的是二进制文件 可以直接使用</span><br><span class="line">cp -r mongodb-linux-x86_64-3.4.1 /usr/local/mongodb</span><br></pre></td></tr></table></figure>
<p>启动服务</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># --dbpath 指定文件存储的目录</span><br><span class="line">/usr/local/mongodb/bin/mongod --dbpath</span><br><span class="line"># 连接客户端</span><br><span class="line">/usr/local/mongodb/bin/mongo</span><br><span class="line">&gt;show dbs</span><br><span class="line">&gt;use admin</span><br><span class="line">&gt;show collections</span><br><span class="line">&gt;db.collection.find()</span><br></pre></td></tr></table></figure>
<h4 id="4-6-php"><a href="#4-6-php" class="headerlink" title="4.6 php"></a>4.6 php</h4><p>下载解压</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http://cn2.php.net/distributions/php-7.0.9.tar.gz</span><br><span class="line">tar -zxvf php-7.0.9.tar.gz</span><br></pre></td></tr></table></figure>
<p>安装依赖包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">yum -y install </span><br><span class="line">openssl openssl-devel \		# 支持 stl</span><br><span class="line">curl curl-devel \			# curl网络请求库</span><br><span class="line">libjpeg libjpeg-devel \		# jpeg图片</span><br><span class="line">libpng libpng-devel \		# png 图片</span><br><span class="line">freetype freetype-devel \	# freetype 字体</span><br><span class="line">libxml2 libxml2-devel \		# xml格式解析</span><br><span class="line">libxslt libxslt-devel \		# </span><br><span class="line">bzip2 bzip2-devel \			# bzip2 压缩库</span><br><span class="line">pcre pcre-devel \			# pcre正则库</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>编译安装<br><a target="_blank" rel="noopener" href="http://php.net/manual/zh/configure.about.php">核心配置选项列表</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">cd php-7.0.9</span><br><span class="line">./configure \</span><br><span class="line">--prefix=/usr/local/php7 \</span><br><span class="line">--exec-prefix=/usr/local/php7 \</span><br><span class="line">--bindir=/usr/local/php7/bin \</span><br><span class="line">--sbindir=/usr/local/php7/sbin \</span><br><span class="line">--includedir=/usr/local/php7/include \</span><br><span class="line">--libdir=/usr/local/php7/lib/php \</span><br><span class="line">--mandir=/usr/local/php7/php/man \</span><br><span class="line">--with-config-file-path=/usr/local/php7/etc \</span><br><span class="line">--with-mysql-sock=/var/run/mysql/mysql.sock \</span><br><span class="line">--with-mcrypt=/usr/include \</span><br><span class="line">--with-mhash \</span><br><span class="line">--with-openssl \</span><br><span class="line">--with-mysqli=shared,mysqlnd \</span><br><span class="line">--with-pdo-mysql=shared,mysqlnd \</span><br><span class="line">--with-gd \</span><br><span class="line">--with-iconv \</span><br><span class="line">--with-zlib \</span><br><span class="line">--enable-zip \</span><br><span class="line">--enable-inline-optimization \</span><br><span class="line">--disable-debug \</span><br><span class="line">--disable-rpath \</span><br><span class="line">--enable-shared \</span><br><span class="line">--enable-xml \</span><br><span class="line">--enable-bcmath \</span><br><span class="line">--enable-shmop \</span><br><span class="line">--enable-sysvsem \</span><br><span class="line">--enable-mbregex \</span><br><span class="line">--enable-mbstring \</span><br><span class="line">--enable-ftp \</span><br><span class="line">--enable-gd-native-ttf \</span><br><span class="line">--enable-pcntl \</span><br><span class="line">--enable-sockets \</span><br><span class="line">--with-xmlrpc \</span><br><span class="line">--enable-soap \</span><br><span class="line">--without-pear \</span><br><span class="line">--with-gettext \</span><br><span class="line">--enable-session \</span><br><span class="line">--with-curl \</span><br><span class="line">--with-jpeg-dir \</span><br><span class="line">--with-freetype-dir \</span><br><span class="line">--enable-opcache \</span><br><span class="line">--enable-fpm \</span><br><span class="line">--with-fpm-user=nginx \</span><br><span class="line">--with-fpm-group=nginx \</span><br><span class="line">--without-gdbm \</span><br><span class="line">--enable-fileinfo</span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>配置相关的修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 添加链接</span><br><span class="line">ln -s /usr/local/php7/bin/php /usr/local/bin</span><br><span class="line"># php配置文件(从源代码中拷贝)</span><br><span class="line">cp php.ini-development /usr/local/php7/etc/php.ini</span><br><span class="line"># php-fpm 配置文件</span><br><span class="line">cp /usr/local/php7/etc/php-fpm.conf.default /usr/local/php7/etc/php-fpm.conf</span><br><span class="line">cp /usr/local/php7/etc/php-fpm.d/www.conf.default /usr/local/php7/etc/php-fpm.d/www.conf</span><br><span class="line"># 修改配置文件</span><br><span class="line">vi /usr/local/php7/etc/php-fpm.d/www.conf</span><br><span class="line">;listen = 127.0.0.1:9000</span><br><span class="line">listen = /dev/shm/php-fpm.sock</span><br><span class="line"># 下面两个选项的注释一定要开启 不然nginx连接fpm的sock会报权限错误</span><br><span class="line">listen.owner = nginx</span><br><span class="line">listen.group = nginx</span><br><span class="line"></span><br><span class="line"># 启动服务</span><br><span class="line">/usr/local/php7/sbin/php-fpm</span><br><span class="line"># 查看是否开启成功</span><br><span class="line">ps -ef | grep php-fpm</span><br><span class="line"># 这个时候查看生成的 php-fpm.sock 的创建者与所属组都是 nginx</span><br><span class="line">ll /dev/shm</span><br></pre></td></tr></table></figure>


<h4 id="4-7-php-ext"><a href="#4-7-php-ext" class="headerlink" title="4.7 php-ext"></a>4.7 php-ext</h4><p>php扩展安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># redis下载解压</span><br><span class="line">wget http://pecl.php.net/get/redis-3.1.0.tgz</span><br><span class="line">tar -zxvf redis-3.1.0.tgz</span><br><span class="line"># mongodb下载解压</span><br><span class="line">wget http://pecl.php.net/get/mongodb-1.2.2.tgz</span><br><span class="line">tar -zxvf mongodb-1.2.2.tgz</span><br><span class="line"># php提供的扩展安装工具</span><br><span class="line"># 在扩展源码根目录下执行</span><br><span class="line"># 生成configure文件</span><br><span class="line">/usr/local/php7/bin/phpize</span><br><span class="line">./configure --with-php-config=/usr/local/php7/bin/php-config</span><br><span class="line"># 编译安装</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>配置文件开启扩展</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/local/php7/etc/php.ini</span><br><span class="line"># 添加如下选项</span><br><span class="line">extension=redis.so</span><br><span class="line">extension=mongodb.so</span><br><span class="line">extension=pdo_mysql.so</span><br><span class="line">zend_extension=opcache.so</span><br><span class="line"># 查看扩展</span><br><span class="line">php -m</span><br></pre></td></tr></table></figure>
<p>composer 安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 下载</span><br><span class="line">curl -sS https://getcomposer.org/installer | php</span><br><span class="line">mv composer.phar /usr/local/bin/composer</span><br><span class="line"># 验证</span><br><span class="line">composer -v</span><br></pre></td></tr></table></figure>
<h2 id="5-常用工具安装"><a href="#5-常用工具安装" class="headerlink" title="5. 常用工具安装"></a>5. 常用工具安装</h2><h4 id="5-1-supervisor"><a href="#5-1-supervisor" class="headerlink" title="5.1 supervisor"></a>5.1 supervisor</h4><p>命令行执行脚本的守护进程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 安装</span><br><span class="line">yum -y install supervisor</span><br><span class="line"># 查看是否安装成功</span><br><span class="line">service supervsord status</span><br></pre></td></tr></table></figure>
<p>配置文件说明</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/supervisord.conf</span><br><span class="line"># 配置详解</span><br><span class="line">[program:任务名称]</span><br><span class="line"># 守护执行的命令</span><br><span class="line">command=/root/test/shell/test</span><br><span class="line"># 命令执行的用户 这里设置出错会导致权限问题</span><br><span class="line">user=root</span><br><span class="line"># 是否自动启动</span><br><span class="line">autostart=true</span><br><span class="line"># 是否自动重启</span><br><span class="line">autorestart=true</span><br><span class="line">startsecs=3</span><br><span class="line"># 是否捕获错误</span><br><span class="line">redirect_stderr=true</span><br><span class="line"># 错误日志</span><br><span class="line">stdout_logfile=/root/test/shellsupervisor.log</span><br></pre></td></tr></table></figure>
<p>基本常用命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 帮助</span><br><span class="line">supervisorctl help</span><br><span class="line"># 查看状态</span><br><span class="line">supervisorctl status</span><br><span class="line"># 修改配置文件需要重新加载</span><br><span class="line">supervisorctl reload</span><br><span class="line"># 重启 启动 停止</span><br><span class="line">supervisorctl start/restart/stop</span><br></pre></td></tr></table></figure>

<p><a href="">参考连接</a></p>
<h4 id="5-2-nfs-utils"><a href="#5-2-nfs-utils" class="headerlink" title="5.2 nfs-utils"></a>5.2 nfs-utils</h4><p>网络磁盘共享 图片文件会用到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 安装</span><br><span class="line">yum -y install nfs-utils</span><br><span class="line"># 查看安装情况</span><br><span class="line">rpm -qa | grep nfs</span><br><span class="line"># --- 看到这些包表示安装成功---</span><br><span class="line">nfs-utils-lib-1.1.5-11.el6.x86_64</span><br><span class="line">nfs-utils-1.2.3-70.el6_8.2.x86_64</span><br><span class="line"># 服务端编辑权限</span><br><span class="line">vi /etc/exports</span><br><span class="line"># /path client_ip (读写权限,访问角色,同步还是异步)</span><br><span class="line">/data/images 192.168.0.* (rw,root_squash,async)</span><br><span class="line"># 权限编辑后需要重新加载生效</span><br><span class="line">exportfs -rv</span><br><span class="line"># 开启服务 (客户端 服务端同时需要开启服务)</span><br><span class="line"># contos 5.x 版本使用的是portmap</span><br><span class="line"># centos 6.x 版本使用的是rpcbind</span><br><span class="line">service rpcbind start</span><br><span class="line">service nfs start</span><br><span class="line"># 客户端挂载硬盘</span><br><span class="line">mount -t nfs remote_ip:/path /local/data</span><br></pre></td></tr></table></figure>

<h4 id="5-3-samba"><a href="#5-3-samba" class="headerlink" title="5.3 samba"></a>5.3 samba</h4><p>目录共享系统</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 安装</span><br><span class="line">yum -y install samba</span><br><span class="line"># 查看安装情况</span><br><span class="line">service smb status</span><br></pre></td></tr></table></figure>
<p>配置文件详解</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/samba/smb.conf</span><br><span class="line"># 修改以下选项 否则每次访问需要登录</span><br><span class="line">#security = user</span><br><span class="line">security = share</span><br><span class="line"></span><br><span class="line"># 添加一个共享目录</span><br><span class="line">[共享的名称]</span><br><span class="line">comment=注释描述</span><br><span class="line">path=/root/share # 共享的文件夹路径</span><br><span class="line">browseable=yes # 是否有浏览权限</span><br><span class="line">guest ok=yes # 访客是否可访问</span><br><span class="line">public=yes  # 是否允许上传</span><br><span class="line">writable=yes # 是否有可写权限</span><br><span class="line"></span><br><span class="line"># 重启服务</span><br><span class="line">service smb restart</span><br></pre></td></tr></table></figure>

<h4 id="5-4-docker-io"><a href="#5-4-docker-io" class="headerlink" title="5.4 docker-io"></a>5.4 docker-io</h4><p>docker安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum -y install docker-io</span><br><span class="line">service docker status</span><br></pre></td></tr></table></figure>
<p><a href="">docker常用命令</a></p>
<h4 id="5-5-git"><a href="#5-5-git" class="headerlink" title="5.5 git"></a>5.5 git</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install git</span><br></pre></td></tr></table></figure>
<p><a href="">git命令详解</a></p>
<h2 id="6-vim-安装与配置"><a href="#6-vim-安装与配置" class="headerlink" title="6. vim 安装与配置"></a>6. vim 安装与配置</h2><h4 id="6-1-vim源码下载解压"><a href="#6-1-vim源码下载解压" class="headerlink" title="6.1 vim源码下载解压"></a>6.1 vim源码下载解压</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget ftp://ftp.vim.org/pub/vim/unix/vim-7.4.tar.bz2</span><br><span class="line">tar -jxvf vim-7.4.tar.bz2</span><br></pre></td></tr></table></figure>
<h4 id="6-2-安装依赖包"><a href="#6-2-安装依赖包" class="headerlink" title="6.2 安装依赖包"></a>6.2 安装依赖包</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">yum install -y lua lua-devel python python-devel perl perl-devel perl-ExtUtils-Embed ruby ruby-devel</span><br><span class="line"># 编译安装 lua-jit</span><br><span class="line">wget http://luajit.org/download/LuaJIT-2.0.4.tar.gz</span><br><span class="line">tar zxf LuaJIT-2.0.4.tar.gz</span><br><span class="line">cd LuaJIT-2.0.4</span><br><span class="line"># 这里安装默认路径 不然编译vim的时候找不到文件</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h4 id="6-3-vim源码-编译安装"><a href="#6-3-vim源码-编译安装" class="headerlink" title="6.3 vim源码 编译安装"></a>6.3 vim源码 编译安装</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">./configure \</span><br><span class="line">--prefix=/usr/local/vim7.4 \</span><br><span class="line">--disable-selinux \</span><br><span class="line">--enable-luainterp=yes \</span><br><span class="line">--enable-perlinterp \</span><br><span class="line">--enable-rubyinterp \</span><br><span class="line">--enable-pythoninterp \</span><br><span class="line">--with-python-config-dir=/usr/lib64/python2.6/config \</span><br><span class="line">--enable-fail-if-missing \</span><br><span class="line">--enable-cscope \</span><br><span class="line">--enable-gui=auto \</span><br><span class="line">--enable-gtk2-check \</span><br><span class="line">--enable-gnome-check \</span><br><span class="line">--with-features=huge \</span><br><span class="line">--with-luajit \</span><br><span class="line">--with-x </span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>

<p>使用 vim 以及错误解决</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/local/vim7.4/bin/vim /usr/local/bin/</span><br><span class="line"># 这个时候使用vim报错</span><br><span class="line"># vim: error while loading shared libraries: libluajit-5.1.so.2: cannot open shared object file: No such file or directory</span><br><span class="line"># 通过生成软连接 解决</span><br><span class="line">ln -s /usr/local/lib/libluajit-5.1.so.2 /lib64/</span><br><span class="line"># 检查插件支持</span><br><span class="line">vim 命令行模式输入</span><br><span class="line">:version</span><br></pre></td></tr></table></figure>

<h4 id="6-4-插件-配置文件安装"><a href="#6-4-插件-配置文件安装" class="headerlink" title="6.4 插件 配置文件安装"></a>6.4 插件 配置文件安装</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 拷贝 .vimrc 配置文件</span><br><span class="line"># 创建目录</span><br><span class="line">mkdir -p ~/.vim/bundle</span><br><span class="line">mkdir -p ~/.vim/colors</span><br></pre></td></tr></table></figure>

<p>安装包管理器 Bundle</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 下载bundle</span><br><span class="line">git clone https://github.com/VundleVim/Vundle.vim.git ~/.vim/bundle/Vundle.vim</span><br><span class="line"># 安装插件</span><br><span class="line">:BundleInstall</span><br></pre></td></tr></table></figure>

<p>安装插件 Command-T</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Command-T 安装 找到下载的源码</span><br><span class="line">cd ~/.vim/bundle/command-t/ruby/command-t</span><br><span class="line">ruby extconf.rb</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<p>安装插件 Ctags</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wget https://nchc.dl.sourceforge.net/project/ctags/ctags/5.8/ctags-5.8.tar.gz</span><br><span class="line">tar zxvf ctags-5.8.tar.gz</span><br><span class="line">cd ctags-5.8</span><br><span class="line">./configure --prefix=/usr/local/ctags</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">ln -s /usr/local/ctags/bin/ctags /usr/local/bin/ctags</span><br><span class="line">ctags --version</span><br></pre></td></tr></table></figure>


<h2 id="7-制作vagrant"><a href="#7-制作vagrant" class="headerlink" title="7. 制作vagrant"></a>7. 制作vagrant</h2><h4 id="7-1-添加sudo用户"><a href="#7-1-添加sudo用户" class="headerlink" title="7.1 添加sudo用户"></a>7.1 添加sudo用户</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 添加用户</span><br><span class="line">useradd vagrat</span><br><span class="line">passwd vagrant</span><br><span class="line">&gt;password: vagrant</span><br><span class="line">#### 7.2  添加vagrant用户到sudoer</span><br><span class="line">visudo</span><br><span class="line"># 增加行</span><br><span class="line">vagrant ALL=(ALL) NOPASSWD:ALL</span><br></pre></td></tr></table></figure>
<p>sudo 文件格式解释</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">user host=(run_as) command</span><br><span class="line"># user 定义用户或者用户组 用户组以 % 开始 如 %vagrant</span><br><span class="line"># host 主机名</span><br><span class="line"># run_as 作为哪个用户执行 不写(run_as) 默认是 root</span><br><span class="line"># command 可执行的命令 这个命令要写全路径 相对路径存在安全问题(用户可以创建同名脚本 以root用户执行脚本 脚本里的命令就可以按照root用户的权限执行了)</span><br><span class="line"># command 前可以通过 NOPASSWD: 来修饰 表示sudo执行命令的时候不用密码</span><br><span class="line">%vagrant ALL=(root) NOPASSWD:/usr/sbin/useradd</span><br><span class="line"># 上面命令定义 vagrant组的用户可以在所有主机以root身份执行 /usr/sbin/useradd 命令且不需要密码</span><br></pre></td></tr></table></figure>
<h4 id="7-3-创建vagrant登录授权key"><a href="#7-3-创建vagrant登录授权key" class="headerlink" title="7.3 创建vagrant登录授权key"></a>7.3 创建vagrant登录授权key</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">su vagrant</span><br><span class="line">mkdir -p /home/vagrant/.ssh</span><br><span class="line">cd /home/vagrant/.ssh</span><br><span class="line">wget https://raw.githubusercontent.com/mitchellh/vagrant/master/keys/vagrant.pub -O authorized_keys</span><br><span class="line">chmod 600 /home/vagrant/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>
<h4 id="7-4-vagrant-打包"><a href="#7-4-vagrant-打包" class="headerlink" title="7.4 vagrant 打包"></a>7.4 vagrant 打包</h4><p>打包虚拟机</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 查看虚拟机</span><br><span class="line">VBoxManage list vms</span><br><span class="line"># vagrant 打包</span><br><span class="line">vagrant package --base VBoxName --output develop.box</span><br><span class="line"># 设置vagrant存储位置 设置系统常量</span><br><span class="line">VAGRANT_HOME=/d/storage/vagrant</span><br></pre></td></tr></table></figure>

<p>使用 vagrant 包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vagrant box add centos-dev develop.box</span><br><span class="line">vagrant init centos-dev </span><br><span class="line">#修改Vagrantfile</span><br><span class="line"># 使用帐号密码登录</span><br><span class="line">config.ssh.username=&quot;vagrant&quot;</span><br><span class="line">config.ssh.password=&quot;vagrant&quot;</span><br><span class="line"># 使用key登录</span><br><span class="line">config.ssh.private_key_path=&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 启动</span><br><span class="line">vagrant up</span><br></pre></td></tr></table></figure>


<p>另外在开发过程中我们常常会修改配置文件<br>这个时候可以将配置文件放在映射的目录<br>然后通过软连接(ln -s) 将文件映射到服务读取的配置文件</p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2017/03/27/laravel-%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E5%AE%9E%E7%8E%B0/"
                    data-tooltip="laravel 中间件的实现"
                    aria-label="上一篇: laravel 中间件的实现"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2016/09/10/%E5%88%A9%E7%94%A8apidoc%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E6%96%B9%E6%A1%88/"
                    data-tooltip="利用apidoc设计文档自动生成方案"
                    aria-label="下一篇: 利用apidoc设计文档自动生成方案"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Diesen Beitrag teilen"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://fantiq.github.io/2017/01/01/%E7%B2%BE-LNMP%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"
                    title="分享到 Facebook"
                    aria-label="分享到 Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://fantiq.github.io/2017/01/01/%E7%B2%BE-LNMP%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"
                    title="分享到 Twitter"
                    aria-label="分享到 Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://fantiq.github.io/2017/01/01/%E7%B2%BE-LNMP%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"
                    title="分享到 Google+"
                    aria-label="分享到 Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Nach oben">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 fantiq. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2017/03/27/laravel-%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E5%AE%9E%E7%8E%B0/"
                    data-tooltip="laravel 中间件的实现"
                    aria-label="上一篇: laravel 中间件的实现"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2016/09/10/%E5%88%A9%E7%94%A8apidoc%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E6%96%B9%E6%A1%88/"
                    data-tooltip="利用apidoc设计文档自动生成方案"
                    aria-label="下一篇: 利用apidoc设计文档自动生成方案"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Diesen Beitrag teilen"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://fantiq.github.io/2017/01/01/%E7%B2%BE-LNMP%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"
                    title="分享到 Facebook"
                    aria-label="分享到 Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://fantiq.github.io/2017/01/01/%E7%B2%BE-LNMP%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"
                    title="分享到 Twitter"
                    aria-label="分享到 Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://fantiq.github.io/2017/01/01/%E7%B2%BE-LNMP%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"
                    title="分享到 Google+"
                    aria-label="分享到 Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Nach oben">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://fantiq.github.io/2017/01/01/%E7%B2%BE-LNMP%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"
                        aria-label="分享到 Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>分享到 Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://fantiq.github.io/2017/01/01/%E7%B2%BE-LNMP%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"
                        aria-label="分享到 Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>分享到 Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=https://fantiq.github.io/2017/01/01/%E7%B2%BE-LNMP%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"
                        aria-label="分享到 Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>分享到 Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avatar.jpg" alt="作者的图片"/>
        
            <h4 id="about-card-name">fantiq</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                China HangZhou
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-ffzlst6ssezilzbbgybxfwuegfobjsmomzthas0h8hymsrrzox2o6dre4owp.min.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
